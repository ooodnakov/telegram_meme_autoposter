{% extends "base.html" %}
{% macro render_table(title, items, columns) %}
<h2>{{ title }}</h2>
<table class="table table-striped">
  <thead>
    <tr>
      <th>{{ _('Source') }}</th>
      {% for field, label in columns %}
      <th>{{ label }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
  {% for item in items %}
    <tr>
      <td>{{ item.source }}</td>
      {% for field, label in columns %}
      <td>
        {{ item[field] }}
        {% if field != 'submissions' %}
        ({{ '%.1f'|format(item[field ~ '_pct']) }}%)
        {% endif %}
      </td>
      {% endfor %}
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endmacro %}
{% block content %}
<div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-2 mb-3">
  <h1 class="m-0">{{ _('Leaderboard') }}</h1>
  <form method="post" action="/leaderboard/reset" class="d-inline">
    <input type="hidden" name="next" value="{{ request.url.path }}">
    <button class="btn btn-outline-secondary btn-sm" type="submit">
      {{ _('Reset leaderboard') }}
    </button>
  </form>
</div>
{{ render_table(_('Most Submissions'), submissions, [('submissions', _('Submissions')), ('approved', _('Approved')), ('rejected', _('Rejected'))]) }}
{{ render_table(_('Most Approved'), approved, [('approved', _('Approved')), ('submissions', _('Submissions')), ('rejected', _('Rejected'))]) }}
{{ render_table(_('Most Rejected'), rejected, [('rejected', _('Rejected')), ('submissions', _('Submissions')), ('approved', _('Approved'))]) }}
{% endblock %}
